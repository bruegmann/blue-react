"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var hasClass = function hasClass(el, className) {
  if (el.classList) return el.classList.contains(className);else return !!el.className.match(new RegExp('(\\s|^)' + className + '(\\s|$)'));
};

var Utilities = {
  hasClass: hasClass,
  addClass: function addClass(el, className) {
    if (el.classList) el.classList.add(className);else if (!hasClass(el, className)) el.className += " " + className;
  },
  removeClass: function removeClass(el, className) {
    if (el.classList) el.classList.remove(className);else if (hasClass(el, className)) el.className = el.className.replace(new RegExp('(\\s|^)' + className + '(\\s|$)'), ' ');
  },
  toggleClass: function toggleClass(element, className) {
    if (!element || !className) {
      return;
    }

    var classString = element.className,
        nameIndex = classString.indexOf(className);

    if (nameIndex === -1) {
      classString += ' ' + className;
    } else {
      classString = classString.substr(0, nameIndex) + classString.substr(nameIndex + className.length);
    }

    element.className = classString;
  },
  startLoading: function startLoading() {
    document.querySelectorAll(".blue-app-loading")[0].style.display = "block";
  },
  finishLoading: function finishLoading() {
    document.querySelectorAll(".blue-app-loading")[0].style.display = "";
  },
  showSuccess: function showSuccess() {
    document.querySelectorAll(".blue-app-status-success")[0].style.display = "flex";
  },
  hideSuccess: function hideSuccess() {
    document.querySelectorAll(".blue-app-status-success")[0].style.display = "";
  },
  toggleActions: function toggleActions() {
    this.toggleClass(document.querySelector(".blue-app-wrapper"), "active");
    this.toggleClass(document.querySelector(".blue-app-grid"), "wrapper-in");
    var els = document.querySelectorAll(".blue-app-actions");

    for (var i = 0; i < els.length; i++) {
      this.toggleClass(els[i], "open");
    }
  },
  resetAlertMessage: function resetAlertMessage() {
    var alertClassName = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : "info";
    var alertElement = document.querySelectorAll(".blue-app-status-alert")[0];
    document.querySelectorAll(".blue-app-status-" + alertClassName)[0].style.display = "";
    alertElement.style.display = "";
    this.removeClass(alertElement, "alert-" + (alertClassName === "loading" ? "info" : alertClassName));
  },
  setAlertMessage: function setAlertMessage(message) {
    var _this = this;

    var alertClassName = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : "info";
    var close = arguments.length > 2 ? arguments[2] : undefined;
    var detailText = arguments.length > 3 ? arguments[3] : undefined;
    var alertElement = document.querySelectorAll(".blue-app-status-alert")[0];

    if (alertClassName.indexOf("alert-") > -1) {
      alertClassName = alertClassName.replace("alert-", "");
    }

    document.querySelectorAll(".blue-app-status-" + alertClassName)[0].style.display = "flex";
    alertElement.style.display = "block";
    this.addClass(alertElement, "alert-" + (alertClassName === "loading" ? "info" : alertClassName));
    alertElement.querySelector(".alert-body").innerHTML = "<h2>" + message + "</h2>";

    if (detailText) {
      alertElement.querySelector(".alert-body").innerHTML += "<span>" + detailText + "</span>";
    }

    if (close) {
      alertElement.querySelector(".close").style.display = "inline-block";

      alertElement.querySelector(".close").onclick = function () {
        _this.resetAlertMessage(alertClassName);
      };
    } else {
      alertElement.querySelector(".close").style.display = "none";
    }
  },
  guid: function guid() {
    function s4() {
      return Math.floor((1 + Math.random()) * 0x10000).toString(16).substring(1);
    }

    return s4() + s4() + '-' + s4() + '-' + s4() + '-' + s4() + '-' + s4() + s4() + s4();
  },
  scrollToTop: function scrollToTop() {
    var routerPage = document.querySelector(".router-page.active");
    routerPage.scroll({
      behavior: "smooth",
      left: 0,
      top: 0
    });
  },
  fluentBtnsListener: function fluentBtnsListener(event, btn) {
    var btnBall = btn.querySelector(".fluent-btn-ball");
    var el = btn.getBoundingClientRect();
    var offset = {
      left: el.left + window.scrollX,
      top: el.top + window.scrollY
    };
    var x = event.pageX - offset.left;
    var y = event.pageY - offset.top;
    btnBall.style.left = x + "px";
    btnBall.style.top = y + "px";
  },
  unregisterFluentBtns: null,
  registerFluentBtns: function registerFluentBtns() {}
};

Utilities.unregisterFluentBtns = function () {
  var btns = document.querySelectorAll(".fluent-btn");
  btns.forEach(function (btn) {
    btn.removeEventListener("mousemove", function (event) {
      return Utilities.fluentBtnsListener(event, btn);
    });
  });
};

Utilities.registerFluentBtns = function () {
  Utilities.unregisterFluentBtns();
  var btns = document.querySelectorAll(".fluent-btn");
  btns.forEach(function (btn) {
    btn.addEventListener("mousemove", function (event) {
      return Utilities.fluentBtnsListener(event, btn);
    });
  });
};

Utilities.fetchData = function (input) {
  var init = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : undefined;
  var showErrorDetail = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;
  return fetch(input, init).then(function (response) {
    if (!response.ok) throw response;
    return response;
  }).catch(function (reason) {
    reason.text().then(function (errorMessage) {
      Utilities.setAlertMessage("".concat(reason.status, " - ").concat(reason.statusText), "danger", true, showErrorDetail ? errorMessage : undefined);
    });
  });
};

var _default = Utilities;
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9jb21wb25lbnRzL1V0aWxpdGllcy5qcyJdLCJuYW1lcyI6WyJoYXNDbGFzcyIsImVsIiwiY2xhc3NOYW1lIiwiY2xhc3NMaXN0IiwiY29udGFpbnMiLCJtYXRjaCIsIlJlZ0V4cCIsIlV0aWxpdGllcyIsImFkZENsYXNzIiwiYWRkIiwicmVtb3ZlQ2xhc3MiLCJyZW1vdmUiLCJyZXBsYWNlIiwidG9nZ2xlQ2xhc3MiLCJlbGVtZW50IiwiY2xhc3NTdHJpbmciLCJuYW1lSW5kZXgiLCJpbmRleE9mIiwic3Vic3RyIiwibGVuZ3RoIiwic3RhcnRMb2FkaW5nIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yQWxsIiwic3R5bGUiLCJkaXNwbGF5IiwiZmluaXNoTG9hZGluZyIsInNob3dTdWNjZXNzIiwiaGlkZVN1Y2Nlc3MiLCJ0b2dnbGVBY3Rpb25zIiwicXVlcnlTZWxlY3RvciIsImVscyIsImkiLCJyZXNldEFsZXJ0TWVzc2FnZSIsImFsZXJ0Q2xhc3NOYW1lIiwiYWxlcnRFbGVtZW50Iiwic2V0QWxlcnRNZXNzYWdlIiwibWVzc2FnZSIsImNsb3NlIiwiZGV0YWlsVGV4dCIsImlubmVySFRNTCIsIm9uY2xpY2siLCJndWlkIiwiczQiLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJ0b1N0cmluZyIsInN1YnN0cmluZyIsInNjcm9sbFRvVG9wIiwicm91dGVyUGFnZSIsInNjcm9sbCIsImJlaGF2aW9yIiwibGVmdCIsInRvcCIsImZsdWVudEJ0bnNMaXN0ZW5lciIsImV2ZW50IiwiYnRuIiwiYnRuQmFsbCIsImdldEJvdW5kaW5nQ2xpZW50UmVjdCIsIm9mZnNldCIsIndpbmRvdyIsInNjcm9sbFgiLCJzY3JvbGxZIiwieCIsInBhZ2VYIiwieSIsInBhZ2VZIiwidW5yZWdpc3RlckZsdWVudEJ0bnMiLCJyZWdpc3RlckZsdWVudEJ0bnMiLCJidG5zIiwiZm9yRWFjaCIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJhZGRFdmVudExpc3RlbmVyIiwiZmV0Y2hEYXRhIiwiaW5wdXQiLCJpbml0IiwidW5kZWZpbmVkIiwic2hvd0Vycm9yRGV0YWlsIiwiZmV0Y2giLCJ0aGVuIiwicmVzcG9uc2UiLCJvayIsImNhdGNoIiwicmVhc29uIiwidGV4dCIsImVycm9yTWVzc2FnZSIsInN0YXR1cyIsInN0YXR1c1RleHQiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBQSxJQUFNQSxRQUFRLEdBQUcsU0FBWEEsUUFBVyxDQUFVQyxFQUFWLEVBQWNDLFNBQWQsRUFBeUI7QUFDdEMsTUFBSUQsRUFBRSxDQUFDRSxTQUFQLEVBQ0ksT0FBT0YsRUFBRSxDQUFDRSxTQUFILENBQWFDLFFBQWIsQ0FBc0JGLFNBQXRCLENBQVAsQ0FESixLQUdJLE9BQU8sQ0FBQyxDQUFDRCxFQUFFLENBQUNDLFNBQUgsQ0FBYUcsS0FBYixDQUFtQixJQUFJQyxNQUFKLENBQVcsWUFBWUosU0FBWixHQUF3QixTQUFuQyxDQUFuQixDQUFUO0FBQ1AsQ0FMRDs7QUFPQSxJQUFJSyxTQUFTLEdBQUc7QUFDWlAsRUFBQUEsUUFBUSxFQUFSQSxRQURZO0FBR1pRLEVBQUFBLFFBQVEsRUFBRSxrQkFBVVAsRUFBVixFQUFjQyxTQUFkLEVBQXlCO0FBQy9CLFFBQUlELEVBQUUsQ0FBQ0UsU0FBUCxFQUNJRixFQUFFLENBQUNFLFNBQUgsQ0FBYU0sR0FBYixDQUFpQlAsU0FBakIsRUFESixLQUVLLElBQUksQ0FBQ0YsUUFBUSxDQUFDQyxFQUFELEVBQUtDLFNBQUwsQ0FBYixFQUNERCxFQUFFLENBQUNDLFNBQUgsSUFBZ0IsTUFBTUEsU0FBdEI7QUFDUCxHQVJXO0FBVVpRLEVBQUFBLFdBQVcsRUFBRSxxQkFBVVQsRUFBVixFQUFjQyxTQUFkLEVBQXlCO0FBQ2xDLFFBQUlELEVBQUUsQ0FBQ0UsU0FBUCxFQUNJRixFQUFFLENBQUNFLFNBQUgsQ0FBYVEsTUFBYixDQUFvQlQsU0FBcEIsRUFESixLQUVLLElBQUlGLFFBQVEsQ0FBQ0MsRUFBRCxFQUFLQyxTQUFMLENBQVosRUFDREQsRUFBRSxDQUFD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cmNlc0NvbnRlbnQiOlsiY29uc3QgaGFzQ2xhc3MgPSBmdW5jdGlvbiAoZWwsIGNsYXNzTmFtZSkge1xyXG4gICAgaWYgKGVsLmNsYXNzTGlzdClcclxuICAgICAgICByZXR1cm4gZWwuY2xhc3NMaXN0LmNvbnRhaW5zKGNsYXNzTmFtZSk7XHJcbiAgICBlbHNlXHJcbiAgICAgICAgcmV0dXJuICEhZWwuY2xhc3NOYW1lLm1hdGNoKG5ldyBSZWdFeHAoJyhcXFxcc3xeKScgKyBjbGFzc05hbWUgKyAnKFxcXFxzfCQpJykpO1xyXG59O1xyXG5cclxubGV0IFV0aWxpdGllcyA9IHtcclxuICAgIGhhc0NsYXNzLFxyXG5cclxuICAgIGFkZENsYXNzOiBmdW5jdGlvbiAoZWwsIGNsYXNzTmFtZSkge1xyXG4gICAgICAgIGlmIChlbC5jbGFzc0xpc3QpXHJcbiAgICAgICAgICAgIGVsLmNsYXNzTGlzdC5hZGQoY2xhc3NOYW1lKTtcclxuICAgICAgICBlbHNlIGlmICghaGFzQ2xhc3MoZWwsIGNsYXNzTmFtZSkpXHJcbiAgICAgICAgICAgIGVsLmNsYXNzTmFtZSArPSBcIiBcIiArIGNsYXNzTmFtZTtcclxuICAgIH0sXHJcblxyXG4gICAgcmVtb3ZlQ2xhc3M6IGZ1bmN0aW9uIChlbCwgY2xhc3NOYW1lKSB7XHJcbiAgICAgICAgaWYgKGVsLmNsYXNzTGlzdClcclxuICAgICAgICAgICAgZWwuY2xhc3NMaXN0LnJlbW92ZShjbGFzc05hbWUpO1xyXG4gICAgICAgIGVsc2UgaWYgKGhhc0NsYXNzKGVsLCBjbGFzc05hbWUpKVxyXG4gICAgICAgICAgICBlbC5jbGFzc05hbWUgPSBlbC5jbGFzc05hbWUucmVwbGFjZShuZXcgUmVnRXhwKCcoXFxcXHN8XiknICsgY2xhc3NOYW1lICsgJyhcXFxcc3wkKScpLCAnICcpO1xyXG4gICAgfSxcclxuXHJcbiAgICB0b2dnbGVDbGFzczogZnVuY3Rpb24gKGVsZW1lbnQsIGNsYXNzTmFtZSkge1xyXG4gICAgICAgIGlmICghZWxlbWVudCB8fCAhY2xhc3NOYW1lKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBjbGFzc1N0cmluZyA9IGVsZW1lbnQuY2xhc3NOYW1lLCBuYW1lSW5kZXggPSBjbGFzc1N0cmluZy5pbmRleE9mKGNsYXNzTmFtZSk7XHJcbiAgICAgICAgaWYgKG5hbWVJbmRleCA9PT0gLTEpIHtcclxuICAgICAgICAgICAgY2xhc3NTdHJpbmcgKz0gJyAnICsgY2xhc3NOYW1lO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgY2xhc3NTdHJpbmcgPSBjbGFzc1N0cmluZy5zdWJzdHIoMCwgbmFtZUluZGV4KSArIGNsYXNzU3RyaW5nLnN1YnN0cihuYW1lSW5kZXggKyBjbGFzc05hbWUubGVuZ3RoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxlbWVudC5jbGFzc05hbWUgPSBjbGFzc1N0cmluZztcclxuICAgIH0sXHJcblxyXG4gICAgc3RhcnRMb2FkaW5nOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5ibHVlLWFwcC1sb2FkaW5nXCIpWzBdLnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCI7XHJcbiAgICB9LFxyXG5cclxuICAgIGZpbmlzaExvYWRpbmc6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLmJsdWUtYXBwLWxvYWRpbmdcIilbMF0uc3R5bGUuZGlzcGxheSA9IFwiXCI7XHJcbiAgICB9LFxyXG5cclxuICAgIHNob3dTdWNjZXNzOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5ibHVlLWFwcC1zdGF0dXMtc3VjY2Vzc1wiKVswXS5zdHlsZS5kaXNwbGF5ID0gXCJmbGV4XCI7XHJcbiAgICB9LFxyXG5cclxuICAgIGhpZGVTdWNjZXNzOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5ibHVlLWFwcC1zdGF0dXMtc3VjY2Vzc1wiKVswXS5zdHlsZS5kaXNwbGF5ID0gXCJcIjtcclxuICAgIH0sXHJcblxyXG4gICAgdG9nZ2xlQWN0aW9uczogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMudG9nZ2xlQ2xhc3MoZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5ibHVlLWFwcC13cmFwcGVyXCIpLCBcImFjdGl2ZVwiKTtcclxuICAgICAgICB0aGlzLnRvZ2dsZUNsYXNzKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuYmx1ZS1hcHAtZ3JpZFwiKSwgXCJ3cmFwcGVyLWluXCIpO1xyXG5cclxuICAgICAgICB2YXIgZWxzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5ibHVlLWFwcC1hY3Rpb25zXCIpO1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZWxzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIHRoaXMudG9nZ2xlQ2xhc3MoZWxzW2ldLCBcIm9wZW5cIik7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICByZXNldEFsZXJ0TWVzc2FnZTogZnVuY3Rpb24gKGFsZXJ0Q2xhc3NOYW1lID0gXCJpbmZvXCIpIHtcclxuICAgICAgICBjb25zdCBhbGVydEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLmJsdWUtYXBwLXN0YXR1cy1hbGVydFwiKVswXTtcclxuICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLmJsdWUtYXBwLXN0YXR1cy1cIiArIGFsZXJ0Q2xhc3NOYW1lKVswXS5zdHlsZS5kaXNwbGF5ID0gXCJcIjtcclxuICAgICAgICBhbGVydEVsZW1lbnQuc3R5bGUuZGlzcGxheSA9IFwiXCI7XHJcbiAgICAgICAgdGhpcy5yZW1vdmVDbGFzcyhhbGVydEVsZW1lbnQsIFwiYWxlcnQtXCIgKyAoYWxlcnRDbGFzc05hbWUgPT09IFwibG9hZGluZ1wiID8gXCJpbmZvXCIgOiBhbGVydENsYXNzTmFtZSkpO1xyXG4gICAgfSxcclxuXHJcbiAgICBzZXRBbGVydE1lc3NhZ2U6IGZ1bmN0aW9uIChtZXNzYWdlLCBhbGVydENsYXNzTmFtZSA9IFwiaW5mb1wiLCBjbG9zZSwgZGV0YWlsVGV4dCkge1xyXG4gICAgICAgIGNvbnN0IGFsZXJ0RWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuYmx1ZS1hcHAtc3RhdHVzLWFsZXJ0XCIpWzBdO1xyXG5cclxuICAgICAgICBpZiAoYWxlcnRDbGFzc05hbWUuaW5kZXhPZihcImFsZXJ0LVwiKSA+IC0xKSB7XHJcbiAgICAgICAgICAgIGFsZXJ0Q2xhc3NOYW1lID0gYWxlcnRDbGFzc05hbWUucmVwbGFjZShcImFsZXJ0LVwiLCBcIlwiKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuYmx1ZS1hcHAtc3RhdHVzLVwiICsgYWxlcnRDbGFzc05hbWUpWzBdLnN0eWxlLmRpc3BsYXkgPSBcImZsZXhcIjtcclxuICAgICAgICBhbGVydEVsZW1lbnQuc3R5bGUuZGlzcGxheSA9IFwiYmxvY2tcIjtcclxuICAgICAgICB0aGlzLmFkZENsYXNzKGFsZXJ0RWxlbWVudCwgXCJhbGVydC1cIiArIChhbGVydENsYXNzTmFtZSA9PT0gXCJsb2FkaW5nXCIgPyBcImluZm9cIiA6IGFsZXJ0Q2xhc3NOYW1lKSk7XHJcblxyXG4gICAgICAgIGFsZXJ0RWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmFsZXJ0LWJvZHlcIikuaW5uZXJIVE1MID0gYDxoMj5gICsgbWVzc2FnZSArIGA8L2gyPmA7XHJcbiAgICAgICAgaWYgKGRldGFpbFRleHQpIHtcclxuICAgICAgICAgICAgYWxlcnRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuYWxlcnQtYm9keVwiKS5pbm5lckhUTUwgKz0gYDxzcGFuPmAgKyBkZXRhaWxUZXh0ICsgYDwvc3Bhbj5gO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKGNsb3NlKSB7XHJcbiAgICAgICAgICAgIGFsZXJ0RWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNsb3NlXCIpLnN0eWxlLmRpc3BsYXkgPSBcImlubGluZS1ibG9ja1wiO1xyXG4gICAgICAgICAgICBhbGVydEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jbG9zZVwiKS5vbmNsaWNrID0gKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5yZXNldEFsZXJ0TWVzc2FnZShhbGVydENsYXNzTmFtZSk7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBhbGVydEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jbG9zZVwiKS5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICBndWlkOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgZnVuY3Rpb24gczQoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBNYXRoLmZsb29yKCgxICsgTWF0aC5yYW5kb20oKSkgKiAweDEwMDAwKVxyXG4gICAgICAgICAgICAgICAgLnRvU3RyaW5nKDE2KVxyXG4gICAgICAgICAgICAgICAgLnN1YnN0cmluZygxKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHM0KCkgKyBzNCgpICsgJy0nICsgczQoKSArICctJyArIHM0KCkgKyAnLScgK1xyXG4gICAgICAgICAgICBzNCgpICsgJy0nICsgczQoKSArIHM0KCkgKyBzNCgpO1xyXG4gICAgfSxcclxuXHJcbiAgICBzY3JvbGxUb1RvcDogKCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IHJvdXRlclBhZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnJvdXRlci1wYWdlLmFjdGl2ZVwiKTtcclxuXHJcbiAgICAgICAgcm91dGVyUGFnZS5zY3JvbGwoe1xyXG4gICAgICAgICAgICBiZWhhdmlvcjogXCJzbW9vdGhcIixcclxuICAgICAgICAgICAgbGVmdDogMCxcclxuICAgICAgICAgICAgdG9wOiAwXHJcbiAgICAgICAgfSk7XHJcbiAgICB9LFxyXG5cclxuICAgIGZsdWVudEJ0bnNMaXN0ZW5lcjogKGV2ZW50LCBidG4pID0+IHtcclxuICAgICAgICBjb25zdCBidG5CYWxsID0gYnRuLnF1ZXJ5U2VsZWN0b3IoXCIuZmx1ZW50LWJ0bi1iYWxsXCIpO1xyXG4gICAgICAgIGNvbnN0IGVsID0gYnRuLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xyXG4gICAgICAgIGNvbnN0IG9mZnNldCA9IHtcclxuICAgICAgICAgICAgbGVmdDogZWwubGVmdCArIHdpbmRvdy5zY3JvbGxYLFxyXG4gICAgICAgICAgICB0b3A6IGVsLnRvcCArIHdpbmRvdy5zY3JvbGxZXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgY29uc3QgeCA9IGV2ZW50LnBhZ2VYIC0gb2Zmc2V0LmxlZnQ7XHJcbiAgICAgICAgY29uc3QgeSA9IGV2ZW50LnBhZ2VZIC0gb2Zmc2V0LnRvcDtcclxuXHJcbiAgICAgICAgYnRuQmFsbC5zdHlsZS5sZWZ0ID0geCArIFwicHhcIjtcclxuICAgICAgICBidG5CYWxsLnN0eWxlLnRvcCA9IHkgKyBcInB4XCI7XHJcbiAgICB9LFxyXG5cclxuICAgIHVucmVnaXN0ZXJGbHVlbnRCdG5zOiBudWxsLFxyXG4gICAgcmVnaXN0ZXJGbHVlbnRCdG5zOiAoKSA9PiB7IH1cclxufTtcclxuXHJcblV0aWxpdGllcy51bnJlZ2lzdGVyRmx1ZW50QnRucyA9ICgpID0+IHtcclxuICAgIGNvbnN0IGJ0bnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLmZsdWVudC1idG5cIik7XHJcblxyXG4gICAgYnRucy5mb3JFYWNoKGJ0biA9PiB7XHJcbiAgICAgICAgYnRuLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtb3VzZW1vdmVcIiwgZXZlbnQgPT4gVXRpbGl0aWVzLmZsdWVudEJ0bnNMaXN0ZW5lcihldmVudCwgYnRuKSk7XHJcbiAgICB9KTtcclxufTtcclxuXHJcblV0aWxpdGllcy5yZWdpc3RlckZsdWVudEJ0bnMgPSAoKSA9PiB7XHJcbiAgICBVdGlsaXRpZXMudW5yZWdpc3RlckZsdWVudEJ0bnMoKTtcclxuXHJcbiAgICBjb25zdCBidG5zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5mbHVlbnQtYnRuXCIpO1xyXG5cclxuICAgIGJ0bnMuZm9yRWFjaChidG4gPT4ge1xyXG4gICAgICAgIGJ0bi5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vtb3ZlXCIsIGV2ZW50ID0+IFV0aWxpdGllcy5mbHVlbnRCdG5zTGlzdGVuZXIoZXZlbnQsIGJ0bikpO1xyXG4gICAgfSk7XHJcbn07XHJcblxyXG5VdGlsaXRpZXMuZmV0Y2hEYXRhID0gZnVuY3Rpb24gKGlucHV0LCBpbml0ID0gdW5kZWZpbmVkLCBzaG93RXJyb3JEZXRhaWwgPSB0cnVlKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goaW5wdXQsIGluaXQpXHJcbiAgICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiB7XHJcbiAgICAgICAgICAgIGlmICghcmVzcG9uc2Uub2spIHRocm93IHJlc3BvbnNlO1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzcG9uc2U7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAuY2F0Y2goKHJlYXNvbikgPT4ge1xyXG4gICAgICAgICAgICByZWFzb24udGV4dCgpLnRoZW4oKGVycm9yTWVzc2FnZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgVXRpbGl0aWVzLnNldEFsZXJ0TWVzc2FnZShgJHtyZWFzb24uc3RhdHVzfSAtICR7cmVhc29uLnN0YXR1c1RleHR9YCwgXCJkYW5nZXJcIiwgdHJ1ZSwgc2hvd0Vycm9yRGV0YWlsID8gZXJyb3JNZXNzYWdlIDogdW5kZWZpbmVkKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IFV0aWxpdGllczsiXX0=